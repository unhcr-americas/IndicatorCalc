<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="IndicatorCalc">
<title>Utilities â€¢ IndicatorCalc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Utilities">
<meta property="og:description" content="IndicatorCalc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">IndicatorCalc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/indicators-calculation-functions.html">Indicators calculation functions</a>
    <a class="dropdown-item" href="../articles/utilities.html">Utilities</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/unhcr-americas/IndicatorCalc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Utilities</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/unhcr-americas/IndicatorCalc/blob/HEAD/vignettes/utilities.Rmd" class="external-link"><code>vignettes/utilities.Rmd</code></a></small>
      <div class="d-none name"><code>utilities.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/unhcr-americas/IndicatorCalc" class="external-link">IndicatorCalc</a></span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/utilities.Rmd: do not edit by hand -->
<!-- Run this 'development' chunk -->
<!-- Store every call to library() that you need to explore your functions -->
<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.

If it is the first time you use {fusen}, after 'description', you can directly run the last chunk of the present file with inflate() inside.
-->
<p>Indicator functions are designed to work based on data stored as a
list - which is the default structure for a complex hierarchical survey
dataset with nested tables.</p>
<p>The default export format from kobotoolbox includes variables names
generated as a concatenation of groups and names.</p>
<p>The indicators calculation are based on specific patterns to be
identified within the variable names. This allow to handle cases where
variables and questions would have been shifted within the sequence of
the questionnaire and through different questions groups.</p>
<p>The indicator functions also check that the data content is the one
expected.</p>
<p>A check log is displayed in the console to keep track of all
issues</p>
<div class="section level2">
<h2 id="generating-data-from-a-specific-form-definition">Generating data from a specific form definition<a class="anchor" aria-label="anchor" href="#generating-data-from-a-specific-form-definition"></a>
</h2>
<p>One key function is to generate a dummy dataset based on a specific
form structure To demonstrate the package we will use the standard
questionnaire and then apply each indicator function to demonstrate
them.</p>
<p>We can then also re-use the function to create dummy data based on
any form and then apply each indicator function to actually verify which
indicators can be created based on the form content.</p>
<div class="section level3">
<h3 id="fct_var_dummy">fct_var_dummy<a class="anchor" aria-label="anchor" href="#fct_var_dummy"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## let's initiate a dataframe with an index of n r records</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">384</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span> <span class="st">"ID-"</span>,</span>
<span>                      <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/as_vector.html" class="external-link">as_vector</a></span><span class="op">(</span></span>
<span>                            <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                            <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">paste0</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          <span class="st">"-"</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, flag <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span></span>
<span>                        <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## test inject select_one  </span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu">fct_var_dummy</span><span class="op">(</span> </span>
<span>          frame <span class="op">=</span> <span class="va">frame</span>,</span>
<span>           name <span class="op">=</span> <span class="st">"testselect_one"</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"select_one"</span>,</span>
<span>           list_opt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"delta"</span><span class="op">)</span>,</span>
<span>           constraint <span class="op">=</span> <span class="cn">NULL</span></span>
<span>           <span class="op">)</span></span>
<span><span class="co">## test inject select_multiple in main</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu">fct_var_dummy</span><span class="op">(</span> </span>
<span>          frame <span class="op">=</span> <span class="va">frame</span>,</span>
<span>          name <span class="op">=</span> <span class="st">"testselect_multiple"</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"select_multiple"</span>,</span>
<span>           list_opt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"delta"</span><span class="op">)</span>,</span>
<span>           constraint <span class="op">=</span> <span class="cn">NULL</span></span>
<span>           <span class="op">)</span></span>
<span></span>
<span><span class="co">## test inject text</span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu">fct_var_dummy</span><span class="op">(</span> </span>
<span>          frame <span class="op">=</span> <span class="va">frame</span>,</span>
<span>          name <span class="op">=</span> <span class="st">"testtext"</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>           list_opt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           constraint <span class="op">=</span> <span class="cn">NULL</span></span>
<span>           <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## test inject numeric  </span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu">fct_var_dummy</span><span class="op">(</span></span>
<span>           frame <span class="op">=</span> <span class="va">frame</span>,</span>
<span>           name <span class="op">=</span> <span class="st">"testnumeric"</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"numeric"</span>,</span>
<span>           list_opt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           constraint <span class="op">=</span> <span class="cn">NULL</span></span>
<span>           <span class="op">)</span></span>
<span></span>
<span><span class="co">## test inject date  </span></span>
<span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="fu">fct_var_dummy</span><span class="op">(</span> </span>
<span>          frame <span class="op">=</span> <span class="va">frame</span>,</span>
<span>          name <span class="op">=</span> <span class="st">"testdate"</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>           list_opt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>           constraint <span class="op">=</span> <span class="cn">NULL</span></span>
<span>           <span class="op">)</span></span>
<span></span>
<span><span class="co">## Preview out out</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">frame</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="6%">
<col width="10%">
<col width="17%">
<col width="16%">
<col width="17%">
<col width="10%">
<col width="8%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">index</th>
<th align="left">testselect_one</th>
<th align="right">testselect_multiple_alpha</th>
<th align="right">testselect_multiple_beta</th>
<th align="right">testselect_multiple_delta</th>
<th align="left">testtext</th>
<th align="right">testnumeric</th>
<th align="left">testdate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">IDâ€“0001</td>
<td align="left">beta</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FreeText_-0001</td>
<td align="right">60</td>
<td align="left">2020-05-20 16:30:59</td>
</tr>
<tr class="even">
<td align="left">IDâ€“0002</td>
<td align="left">alpha</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">FreeText_-0002</td>
<td align="right">5</td>
<td align="left">2021-11-09 06:47:05</td>
</tr>
<tr class="odd">
<td align="left">IDâ€“0003</td>
<td align="left">beta</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FreeText_-0003</td>
<td align="right">75</td>
<td align="left">2021-02-17 17:35:59</td>
</tr>
<tr class="even">
<td align="left">IDâ€“0004</td>
<td align="left">beta</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">FreeText_-0004</td>
<td align="right">39</td>
<td align="left">2021-06-14 10:43:58</td>
</tr>
<tr class="odd">
<td align="left">IDâ€“0005</td>
<td align="left">alpha</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FreeText_-0005</td>
<td align="right">7</td>
<td align="left">2022-09-27 23:57:16</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="fct_kobo_dummy">fct_kobo_dummy<a class="anchor" aria-label="anchor" href="#fct_kobo_dummy"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## generate dummy dataset for different form version</span></span>
<span></span>
<span><span class="co">## CAPI</span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_kobo_dummy.html">fct_kobo_dummy</a></span><span class="op">(</span><span class="va">form</span>,</span>
<span>                       n <span class="op">=</span> <span class="fl">384</span>,</span>
<span>                       file <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co"># openxlsx::write.xlsx(datalist, here::here("inst", "dummy_RMS_CAPI_v2.xlsx"))</span></span>
<span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v3.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_kobo_dummy.html">fct_kobo_dummy</a></span><span class="op">(</span><span class="va">form</span>,</span>
<span>                       n <span class="op">=</span> <span class="fl">384</span>,</span>
<span>                       file <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Expected 2 pieces. Additional pieces discarded in 1 rows [376].</span></span>
<span><span class="co"># openxlsx::write.xlsx(datalist, here::here("inst", "dummy_RMS_CAPI_v3.xlsx"))</span></span>
<span></span>
<span><span class="co">## CATI</span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CATI_v0.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_kobo_dummy.html">fct_kobo_dummy</a></span><span class="op">(</span><span class="va">form</span>,</span>
<span>                       n <span class="op">=</span> <span class="fl">384</span>,</span>
<span>                       file <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co"># openxlsx::write.xlsx(datalist, here::here("inst", "dummy_RMS_CATI_v0.xlsx"))</span></span>
<span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CATI_v3.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_kobo_dummy.html">fct_kobo_dummy</a></span><span class="op">(</span><span class="va">form</span>,</span>
<span>                       n <span class="op">=</span> <span class="fl">384</span>,</span>
<span>                       file <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Expected 2 pieces. Additional pieces discarded in 1 rows [326].</span></span>
<span><span class="co"># openxlsx::write.xlsx(datalist, here::here("inst", "dummy_RMS_CATI_v3.xlsx"))</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="data-wrangling">Data Wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"></a>
</h2>
<p>Each indicator calculation is based on predefined frame, variable
name and variable value. Some data wrangling is therefore required
before performing the calculations.</p>
<p>The packages comes with tool to support this task. The original data
can be transformed with the function fct_re_map(). The mapper object is
build with the <code><a href="../reference/fct_build_map.html">fct_build_map()</a></code> function, which require 2
files:</p>
<ul>
<li><p><code>IndicatorRequirementFile</code> thi files is created from
the orginal template and indicator scripts. It creates a mapping between
question variables and indicator variables.</p></li>
<li><p><code>mappingfile</code> this one is created once and is designed
to double check that the mapping can actually be performed. To obtain
this file, we Apply fuzzy matching <code><a href="../reference/fct_var_mapping.html">fct_var_mapping()</a></code> to map
within a specified XlsForm the expected variables for indicator
calculation. The output is a convenient excel file that will need to be
manually revised. The process is very similar than data cleaning with a
cleaning log as implemented within <a href="https://edouard-legoupil.github.io/cleaningtools/" class="external-link">{cleaningtools}</a></p></li>
</ul>
<p>The data wrangling is then done with the function
<code><a href="../reference/fct_re_map.html">fct_re_map()</a></code> to obtain the data in the exact format
expected by the indicator calculation functions</p>
<p>Before doing indicator calculation, <code><a href="../reference/fct_check_map.html">fct_check_map()</a></code>
checks that standard frame/variable/modalities are present in the
dataset.</p>
<div class="section level3">
<h3 id="fct_var_mapping">fct_var_mapping<a class="anchor" aria-label="anchor" href="#fct_var_mapping"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test the function</span></span>
<span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">IndicatorRequirementFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2_mapper.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="co"># Get the map to revise</span></span>
<span><span class="va">mapper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_var_mapping.html">fct_var_mapping</a></span><span class="op">(</span>xlsformpath <span class="op">=</span> <span class="va">form</span>,</span>
<span>                          IndicatorRequirementFile <span class="op">=</span> <span class="va">IndicatorRequirementFile</span>,</span>
<span>                       mappingfile_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>                         <span class="co">#      here::here("inst", "RMS_CAPI_v2_mapping.xlsx"))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fct_build_map">fct_build_map<a class="anchor" aria-label="anchor" href="#fct_build_map"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mappingfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2_mapping.xlsx"</span>, </span>
<span>                           package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IndicatorRequirementFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2_mapper.xlsx"</span>, </span>
<span>                           package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mappermain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_map.html">fct_build_map</a></span><span class="op">(</span>mappingfile <span class="op">=</span> <span class="va">mappingfile</span>, </span>
<span>                            IndicatorRequirementFile <span class="op">=</span> <span class="va">IndicatorRequirementFile</span>,</span>
<span>                            thisMeasureLevel <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mapperind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_map.html">fct_build_map</a></span><span class="op">(</span>mappingfile <span class="op">=</span> <span class="va">mappingfile</span>,</span>
<span>                            IndicatorRequirementFile <span class="op">=</span> <span class="va">IndicatorRequirementFile</span>,</span>
<span>                           thisMeasureLevel <span class="op">=</span> <span class="st">"ind"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fct_get_all_variable_names">fct_get_all_variable_names<a class="anchor" aria-label="anchor" href="#fct_get_all_variable_names"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu">kobocruncher</span><span class="fu">::</span><span class="fu"><a href="https://Edouard-Legoupil.github.io/kobocruncher/reference/kobo_data.html" class="external-link">kobo_data</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"demo_data.xlsx"</span>, <span class="co">#"test.xlsx", </span></span>
<span>                                             package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">varname</span> <span class="op">&lt;-</span>   <span class="fu"><a href="../reference/fct_get_all_variable_names.html">fct_get_all_variable_names</a></span><span class="op">(</span>datalist <span class="op">=</span> <span class="va">datalist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">varname</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 Ã— 2</span></span></span>
<span><span class="co">#&gt;    df    value              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> main  _index             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> main  start              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> main  end                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> main  start_time_1       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> main  intro.intro        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> main  intro.interviewdate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> main  intro.Bureau       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> main  intro.Country      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> main  intro.countryname  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> main  intro.geopoint</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fct_re_map">fct_re_map<a class="anchor" aria-label="anchor" href="#fct_re_map"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapper</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            hierarchy <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>            variablemap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Does this household use anything for lighting?"</span>,</span>
<span>                        <span class="st">"What source of electricity is used most of the time in this household?"</span><span class="op">)</span>,</span>
<span>              variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIGHT01"</span>, </span>
<span>                           <span class="st">"LIGHT03"</span><span class="op">)</span>,</span>
<span>              mappattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIGHT01"</span>, </span>
<span>                           <span class="st">"LIGHT03"</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>            modalitymap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>              variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"LIGHT01"</span>, </span>
<span>                            <span class="st">"LIGHT03"</span>, <span class="st">"LIGHT03"</span>, <span class="st">"LIGHT03"</span><span class="op">)</span>,</span>
<span>              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"yes"</span>,</span>
<span>                <span class="st">"No electricity in household"</span>, <span class="st">"Other, specify"</span>, <span class="st">"Don\'t know"</span><span class="op">)</span>,</span>
<span>              standard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"1"</span>,</span>
<span>                           <span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span><span class="op">)</span>,</span>
<span>              map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>,</span>
<span>                      <span class="st">"Noelec"</span>, <span class="st">"Other"</span>, <span class="st">"Dontknow"</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## One variable is not correctly </span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mainhousehold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>                group.LIGHT01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yes"</span>,  <span class="st">"yes"</span>,  <span class="st">"no"</span>, <span class="st">"yes"</span>,  <span class="st">"yes"</span>,</span>
<span>                                  <span class="st">"no"</span>, <span class="st">"yes"</span>,  <span class="st">"yes"</span>,  <span class="st">"yes"</span><span class="op">)</span>,</span>
<span>                group.LIGHT03 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Noelec"</span>, <span class="st">"Other"</span>, <span class="st">"Dontknow"</span>, <span class="st">"Noelec"</span>, <span class="st">"Other"</span>,</span>
<span>                                  <span class="st">"Dontknow"</span>, <span class="st">"Nuclear"</span>, <span class="st">"Other"</span>, <span class="st">"Dontknow"</span><span class="op">)</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_re_map.html">fct_re_map</a></span><span class="op">(</span>datalist <span class="op">=</span> <span class="va">datalist</span>, mapper <span class="op">=</span> <span class="va">mapper</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Mapped levels for LIGHT01 are now: 1, no</span></span>
<span><span class="co">#&gt; Mapped levels for LIGHT03 are now: 1, 96, 98, Nuclear</span></span>
<span></span>
<span><span class="co">#fct_check_map(datalist = datalist, mapper = mapper )</span></span>
<span></span>
<span><span class="co">## Now testing on a full remap...</span></span>
<span><span class="co">## Dummy data created with fct_kobo_dummy</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu">kobocruncher</span><span class="fu">::</span><span class="fu"><a href="https://Edouard-Legoupil.github.io/kobocruncher/reference/kobo_data.html" class="external-link">kobo_data</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"dummy_RMS_CAPI_v2.xlsx"</span>,</span>
<span>                                                 package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Mapping file created from Dummy data  </span></span>
<span><span class="va">mappingfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2_mapping.xlsx"</span>, </span>
<span>                           package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IndicatorRequirementFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2_mapper.xlsx"</span>, </span>
<span>                           package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## and now we remap both required variables for main and ind</span></span>
<span><span class="va">mappermain</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_map.html">fct_build_map</a></span><span class="op">(</span>mappingfile <span class="op">=</span> <span class="va">mappingfile</span>, </span>
<span>                            IndicatorRequirementFile <span class="op">=</span> <span class="va">IndicatorRequirementFile</span>,</span>
<span>                            thisMeasureLevel <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_re_map.html">fct_re_map</a></span><span class="op">(</span>datalist <span class="op">=</span> <span class="va">datalist</span>, mapper <span class="op">=</span> <span class="va">mappermain</span> <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> HEA01 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for HEA01 are now: 1, 2, 3, 4, 5, 96, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> HEA02 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for HEA02 are now: 1, 2, 3, 96</span></span>
<span><span class="co">#&gt; Mapped levels for HEA03 are now: 0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 3, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 4, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 5, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 6, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 7, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 8, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 9, 90, 91, 92, 93, 94, 95</span></span>
<span><span class="co">#&gt; Mapped levels for LIGHT01 are now: 0, 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> LIGHT02 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for LIGHT02 are now: 1, 10, 11, 12, 13, 2, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> LIGHT03 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for LIGHT03 are now: 1, 2, 3, 4, 5, 6, 7, 8, 96, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWA01 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWA01 are now: 1, 10, 11, 12, 13, 14, 15, 16, 2, 3, 4, 5, 6, 7, 8, 9, 96, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWA02 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWA02 are now: 1, 2, 3</span></span>
<span><span class="co">#&gt; Mapped levels for DWA03a are now: 1, 2</span></span>
<span><span class="co">#&gt; Mapped levels for DWA03b are now: 0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 3, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 4, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 5, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 6, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 7, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 8, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 9, 90, 91, 92, 93, 94, 95</span></span>
<span><span class="co">#&gt; Mapped levels for DWA04 are now: 0, 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWE01 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWE01 are now: 1, 2, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWE02 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWE02 are now: 1, 2, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWE03 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWE03 are now: 1, 10, 11, 12, 13, 2, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWE04 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWE04 are now: 1, 10, 11, 12, 13, 14, 15, 2, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; Mapped levels for DWE05 are now: 0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 3, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 4, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 5, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 6, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 7, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 8, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 9, 90, 91, 92, 93, 94, 95</span></span>
<span><span class="co">#&gt; Mapped levels for DWE08 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for DWE09 are now: 1, 2, 3, 4</span></span>
<span><span class="co">#&gt; Mapped levels for HH01 are now: 0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 3, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 4, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 5, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 6, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 7, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 8, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 9, 90, 91, 92, 93, 94, 95</span></span>
<span><span class="co">#&gt; Mapped levels for SAF01 are now: 1, 2, 3, 4, 98, 99</span></span>
<span><span class="co">#&gt; Mapped levels for GBV01a are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for GBV01b are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for GBV01c are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for GBV01d are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for VAW01a are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for VAW01b are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for VAW01c are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for VAW01d are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for VAW01e are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for BIR01 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for BIR02 are now: 0, 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> BIR03 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; The following `from` values were not present in `x`: 2, 3, 4, 5, 6, 96, 98</span></span>
<span><span class="co">#&gt; Mapped levels for BIR03 are now: 0, 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> BIR04 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for BIR04 are now: 1, 2, 3, 96</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> TOI01 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for TOI01 are now: 1, 10, 11, 12, 2, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; Mapped levels for TOI02 are now: 1, 2, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> COOK02 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for COOK02 are now: 1, 10, 2, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> COOK03 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for COOK03 are now: 1, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 21, 3, 4, 5, 6, 7, 8, 9, 96</span></span>
<span><span class="co">#&gt; Mapped levels for BANK01 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for BANK02 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for BANK03 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for BANK04 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for BANK05 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for INC01 are now: 1, 2, 3, 98</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM01 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM02 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM03 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM04 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM05 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM06 are now: 1, 2, 3</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM07 are now: 1, 2, 3</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM08 are now: 1, 2, 3, 4</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM09 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for UNEM10 are now: 0, 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWE06 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWE06 are now: 1, 2, 3, 4, 5, 6, 7, 8, 9, 96, 98, 99</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWE07 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWE07 are now: 1, 10, 11, 2, 3, 4, 5, 6, 7, 8, 9, 96, 98, 99</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> DWE10 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for DWE10 are now: 1, 2, 3, 4, 5, 6, 96</span></span>
<span><span class="co">#&gt; Mapped levels for DWE11 are now: 1, 2, 3, 4, 99</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01a are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01b are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01c are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01d are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01e are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01f are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01g are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for SPF01h are now: 0, 1, 98</span></span>
<span></span>
<span><span class="va">mapperind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_map.html">fct_build_map</a></span><span class="op">(</span>mappingfile <span class="op">=</span> <span class="va">mappingfile</span>, </span>
<span>                            IndicatorRequirementFile <span class="op">=</span> <span class="va">IndicatorRequirementFile</span>,</span>
<span>                           thisMeasureLevel <span class="op">=</span> <span class="st">"ind"</span><span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_re_map.html">fct_re_map</a></span><span class="op">(</span>datalist <span class="op">=</span> <span class="va">datalist</span>, mapper <span class="op">=</span> <span class="va">mapperind</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Mapped levels for HACC01 are now: 0, 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> HACC02 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; The following `from` values were not present in `x`: 2, 3, 4, 5, 96</span></span>
<span><span class="co">#&gt; Mapped levels for HACC02 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for HACC03 are now: 0, 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> HACC04 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; The following `from` values were not present in `x`: 2, 3, 4, 5, 6, 7, 8, 9, 10, 96</span></span>
<span><span class="co">#&gt; Mapped levels for HACC04 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for EDU01 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for EDU02 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for EDU03 are now: 1, 2, 3, 4, 5, 6, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> EDU04 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for EDU04 are now: 1, 2, 3, 4, 5, 96, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> HH07 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for HH07 are now: 0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 3, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 4, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 5, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 6, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 7, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 8, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 9, 90, 91, 92, 93, 94, 95</span></span>
<span><span class="co">#&gt; Mapped levels for REG03 are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for REG04 are now: 0, 1, 98, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG01a are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG01b are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG01c are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG01d are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG01e are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG01f are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG01g are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG02 are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG05a are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG05b are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG05c are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG05d are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG05e are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG05f are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for REG06 are now: 0, 1, 99</span></span>
<span><span class="co">#&gt; Mapped levels for COMM01 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for COMM02 are now: 0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 3, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 4, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 5, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 6, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 7, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 8, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 9, 90, 91, 92, 93, 94, 95</span></span>
<span><span class="co">#&gt; Mapped levels for COMM03 are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for COMM04 are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; Mapped levels for MMR03 are now: 0, 1, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> TOI03 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for TOI03 are now: 1, 2, 3, 4, 5, 96, 98</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> TOI04 variable has more than one variable pattern match in the dataset. We will take the first one but good to check...</span></span>
<span><span class="co">#&gt; Mapped levels for TOI04 are now: 1, 2, 3</span></span>
<span><span class="co">#&gt; Mapped levels for TOI05 are now: 0, 1</span></span>
<span><span class="co">#&gt; Mapped levels for COOK01 are now: 0, 1</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## Writing this in the installation folder of the packages to run all examples</span></span>
<span><span class="co"># openxlsx::write.xlsx( list ( main = as.data.frame(datalist[["main"]]),</span></span>
<span><span class="co">#                              ind = as.data.frame(datalist[["ind"]]) ), </span></span>
<span><span class="co">#                       here::here("inst","dummy_RMS_CAPI_v2_mapped.xlsx"))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fct_check_map">fct_check_map<a class="anchor" aria-label="anchor" href="#fct_check_map"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## below is the mapper to chck if we have the variables to calculate the </span></span>
<span><span class="co"># electricity subindicators within impact 2.2</span></span>
<span><span class="va">mapper</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            hierarchy <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>            variablemap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span><span class="st">"Does this household use anything for lighting?"</span>,</span>
<span><span class="st">"What source of electricity is used most of the time in this household?"</span><span class="op">)</span>,</span>
<span>              variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIGHT01"</span>, </span>
<span>                           <span class="st">"LIGHT03"</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>            modalitymap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>              variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"LIGHT01"</span>, </span>
<span>                            <span class="st">"LIGHT03"</span>, <span class="st">"LIGHT03"</span>, <span class="st">"LIGHT03"</span><span class="op">)</span>,</span>
<span>              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"yes"</span>,</span>
<span>          <span class="st">"No electricity in household"</span>, <span class="st">"Other, specify"</span>, <span class="st">"Don\'t know"</span><span class="op">)</span>,</span>
<span>              standard <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"1"</span>,</span>
<span>                           <span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span></span>
<span><span class="co">## Correct format</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>                LIGHT01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,  <span class="st">"1"</span>,  <span class="st">"0"</span>, <span class="st">"1"</span>,  <span class="st">"1"</span>,  <span class="st">"0"</span>, <span class="st">"1"</span>,  <span class="st">"1"</span>,  <span class="st">"1"</span><span class="op">)</span>,</span>
<span>                LIGHT03 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span>, <span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span>, <span class="st">"0"</span>, <span class="st">"96"</span>, <span class="st">"98"</span><span class="op">)</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_check_map.html">fct_check_map</a></span><span class="op">(</span>datalist <span class="op">=</span> <span class="va">data</span>, mapper <span class="op">=</span> <span class="va">mapper</span> <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> LIGHT01</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> LIGHT03</span></span>
<span><span class="va">check</span></span>
<span><span class="co">#&gt; [1] "TRUE"</span></span>
<span></span>
<span><span class="co">## One variable is not correctly </span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>                LIGHT01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,  <span class="st">"1"</span>,  <span class="st">"0"</span>, <span class="st">"1"</span>,  <span class="st">"1"</span>,  <span class="st">"0"</span>, <span class="st">"1"</span>,  <span class="st">"1"</span>,  <span class="st">"1"</span><span class="op">)</span>,</span>
<span>                LIGH03 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span>, <span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span>, <span class="st">"0"</span>, <span class="st">"96"</span>, <span class="st">"98"</span><span class="op">)</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_check_map.html">fct_check_map</a></span><span class="op">(</span>datalist <span class="op">=</span> <span class="va">data</span>, mapper <span class="op">=</span> <span class="va">mapper</span> <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> LIGHT01</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">âœ–</span> LIGHT03 not found in the dataset.</span></span>
<span><span class="va">check</span> </span>
<span><span class="co">#&gt; [1] "FALSE"</span></span>
<span></span>
<span><span class="co">## The first variable does not include a single 1...</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>                LIGHT01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>,  <span class="st">"0"</span>,  <span class="st">"0"</span>, <span class="st">"0"</span>,  <span class="st">"0"</span>,  <span class="st">"0"</span>, <span class="st">"0"</span>,  <span class="st">"0"</span>,  <span class="st">"0"</span><span class="op">)</span>,</span>
<span>                LIGHT03 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span>, <span class="st">"1"</span>, <span class="st">"96"</span>, <span class="st">"98"</span>, <span class="st">"0"</span>, <span class="st">"96"</span>, <span class="st">"98"</span><span class="op">)</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_check_map.html">fct_check_map</a></span><span class="op">(</span>datalist <span class="op">=</span> <span class="va">data</span>, mapper <span class="op">=</span> <span class="va">mapper</span> <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> LIGHT01 misses responses options among : 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">âœ”</span> LIGHT03</span></span>
<span><span class="va">check</span> </span>
<span><span class="co">#&gt; [1] "FALSE"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<div class="section level3">
<h3 id="fct_plot_indic_donut">fct_plot_indic_donut<a class="anchor" aria-label="anchor" href="#fct_plot_indic_donut"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  shelter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span> shelter <span class="op">=</span> </span>
<span>  <span class="fu">labelled</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span> <span class="va">shelter</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"Yes"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"No"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>label <span class="op">=</span> <span class="st">"Access to adequate shelter also testing a long title to see if it wraps well"</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="fu"><a href="../reference/fct_plot_indic_donut.html">fct_plot_indic_donut</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">shelter</span>,</span>
<span>                     subtitle_chart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     caption_chart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     ordered_threhold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     iconunicode <span class="op">=</span> <span class="st">"e54f"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="utilities_files/figure-html/example-fct_plot_indic_donut-1.png" width="288"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## test no value</span></span>
<span><span class="va">test2</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu"><a href="../reference/fct_plot_indic_donut.html">fct_plot_indic_donut</a></span><span class="op">(</span>indicator <span class="op">=</span> <span class="va">test2</span>,</span>
<span>                     subtitle_chart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     caption_chart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     ordered_threhold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     iconunicode <span class="op">=</span> <span class="st">"e54f"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; No value was supplied for plotting...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fct_plot_rbm_sdg---sdg-comparison">fct_plot_rbm_sdg - SDG Comparison<a class="anchor" aria-label="anchor" href="#fct_plot_rbm_sdg---sdg-comparison"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/fct_plot_rbm_sdg.html">fct_plot_rbm_sdg</a></span><span class="op">(</span> country <span class="op">=</span> <span class="st">"BRA"</span>,</span>
<span>          rbm <span class="op">=</span> <span class="st">"impact2_2"</span>,</span>
<span>          years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2022</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">unhcrthemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/unhcrthemes/man/theme_unhcr.html" class="external-link">theme_unhcr</a></span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<p><img src="utilities_files/figure-html/example-fct_plot_rbm_sdg-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="export-indicator-table">Export Indicator table<a class="anchor" aria-label="anchor" href="#export-indicator-table"></a>
</h2>
<div class="section level3">
<h3 id="fct_compass_table">fct_compass_table<a class="anchor" aria-label="anchor" href="#fct_compass_table"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compass &lt;- export_compass_fill( country = "ECU",</span></span>
<span><span class="co">#                        operation = "Ecuador ABC",</span></span>
<span><span class="co">#                        year = 2022,</span></span>
<span><span class="co">#                         population_type = c("REF","ASY", "OIP"),</span></span>
<span><span class="co">#                         population_rms = "Refugees and Asylum-seekers",</span></span>
<span><span class="co">#                         rms_indicator =    rbind(</span></span>
<span><span class="co">#   c("main", "impact2_2",  "2.2 Proportion of PoCs residing in physically safe and</span></span>
<span><span class="co">#                            secure settlements with access to basic facilities"),</span></span>
<span><span class="co">#   c("main", "impact2_3",  "2.3 Proportion of PoC with access to health services"),</span></span>
<span><span class="co">#   c("P2.S3", "impact3_2a", "3.2a Proportion of PoC enrolled in primary education" ),</span></span>
<span><span class="co">#   c("P2.S3", "impact3_2b",  "3.2b Proportion of PoC enrolled in secondary education" ),</span></span>
<span><span class="co">#   c("main", "impact3_3",  "3.3 Proportion of PoC feeling safe walking alone in their neighborhood (related SDG 16.1.4)." ),</span></span>
<span><span class="co">#   c("S2", "outcome1_2", "1.2 Proportion of children under 5 years of age whose births</span></span>
<span><span class="co">#                    have been registered with a civil authority. [SDG 16.9.1 - Tier 1]" ),</span></span>
<span><span class="co">#   c("S2", "outcome1_3", "1.3 Proportion of PoC with legally recognized identity documents or credentials [GCR 4.2.2]." ),</span></span>
<span><span class="co">#   c("main", "outcome4_1", "4.1 Proportion of PoC who know where to access available GBV services." ),</span></span>
<span><span class="co">#   c("main", "outcome4_2", "4.2 Proportion of POCs who do not accept violence against women." ),</span></span>
<span><span class="co">#   c("main", "outcome8_2", "8.2 Proportion of PoC with primary reliance on clean (cooking) fuels and technology [SDG 7.1.2 Tier 1]" ),</span></span>
<span><span class="co">#   c("main", "outcome9_1", "9.1 Proportion of PoCs living in habitable and affordable housing." ),</span></span>
<span><span class="co">#   c("main", "outcome9_2", "9.2 Proportion of PoC that have energy to ensure lighting (close to Sphere)." ),</span></span>
<span><span class="co">#   c("main","outcome12_1", "12.1 Proportion of PoC using at least basic drinking water services (SDG)." ),</span></span>
<span><span class="co"># #  c("main" , "outcome12_2", "12.2 Proportion of PoC with access to a safe household toilet (SDG)." ),</span></span>
<span><span class="co">#   c("main", "outcome13_1", "13.1. Proportion of PoC with an account at a bank or other</span></span>
<span><span class="co">#                               financial institution or with a mobile-money-service provider [SDG 8.10.2 Tier 1]." ),</span></span>
<span><span class="co">#   c("main", "outcome13_2", "13.2. Proportion of PoC who self-report positive changes in their income compared to previous year." ),</span></span>
<span><span class="co">#   c("main", "outcome13_3",  "13.3 Proportion of PoC (working age) who are unemployed." ),</span></span>
<span><span class="co">#   c("main", "outcome16_1", "16.1. Proportion of PoC with secure tenure rights and/or</span></span>
<span><span class="co">#     property rights to housing and/or land [revised SDG indicator 1.4.2]." )#,</span></span>
<span><span class="co">#  # c("main", "outcome16_2", "16.2. Proportion of PoC covered by social protection floors/systems [SDG 1.3.1]." )</span></span>
<span><span class="co">#      ),</span></span>
<span><span class="co">#              ridl = params$ridl,</span></span>
<span><span class="co">#              publish = params$publish )</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="utilities">Utilities<a class="anchor" aria-label="anchor" href="#utilities"></a>
</h2>
<div class="section level3">
<h3 id="fct_build_requirement">fct_build_requirement<a class="anchor" aria-label="anchor" href="#fct_build_requirement"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Write in dev/mapper.R each of the function parameters - as recorded in  system.file("IndicMap.xlsx", package = "IndicatorCalc")</span></span>
<span><span class="va">xlsformpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v2.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">RMS_CAPI_v2_mapper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_requirement.html">fct_build_requirement</a></span><span class="op">(</span><span class="va">xlsformpath</span> <span class="op">)</span></span>
<span><span class="co">#&gt; /tmp/RtmpPIdgag/filec82f1055d2f8</span></span>
<span><span class="co"># openxlsx::write.xlsx(RMS_CAPI_v2_mapper, here::here("inst", "RMS_CAPI_v2_mapper.xlsx"))</span></span>
<span></span>
<span><span class="va">xlsformpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CAPI_v3.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">RMS_CAPI_v3_mapper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_requirement.html">fct_build_requirement</a></span><span class="op">(</span><span class="va">xlsformpath</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Expected 2 pieces. Additional pieces discarded in 1 rows [376].</span></span>
<span><span class="co">#&gt; /tmp/RtmpPIdgag/filec82f49f37502</span></span>
<span><span class="co"># openxlsx::write.xlsx(RMS_CAPI_v3_mapper, here::here("inst", "RMS_CAPI_v3_mapper.xlsx"))</span></span>
<span></span>
<span><span class="co">## CATI</span></span>
<span><span class="va">xlsformpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CATI_v0.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">RMS_CATI_v0_mapper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_requirement.html">fct_build_requirement</a></span><span class="op">(</span><span class="va">xlsformpath</span> <span class="op">)</span></span>
<span><span class="co">#&gt; /tmp/RtmpPIdgag/filec82f1d9d8d8</span></span>
<span><span class="co"># openxlsx::write.xlsx(RMS_CATI_v0_mapper, here::here("inst", "RMS_CATI_v0_mapper.xlsx"))</span></span>
<span></span>
<span><span class="va">xlsformpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"RMS_CATI_v3.xlsx"</span>, package <span class="op">=</span> <span class="st">"IndicatorCalc"</span><span class="op">)</span></span>
<span><span class="va">RMS_CATI_v3_mapper</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fct_build_requirement.html">fct_build_requirement</a></span><span class="op">(</span><span class="va">xlsformpath</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Expected 2 pieces. Additional pieces discarded in 1 rows [326].</span></span>
<span><span class="co">#&gt; /tmp/RtmpPIdgag/filec82f7575de8</span></span>
<span><span class="co"># openxlsx::write.xlsx(RMS_CATI_v3_mapper, here::here("inst", "RMS_CATI_v3_mapper.xlsx"))</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Edouard Legoupil.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
